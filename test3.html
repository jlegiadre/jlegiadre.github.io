<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Personal & Professional Portfoio Site of Jonathan Legiadre</title>
	<link href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,400;0,700;1,400&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
	
	<link rel="icon" type="image/png" href="favicon/favicon-96x96.png" sizes="96x96" />
	<link rel="icon" type="image/svg+xml" href="favicon/favicon.svg" />
	<link rel="shortcut icon" href="favicon/favicon.ico" />
	<link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png" />
	<link rel="manifest" href="favicon/site.webmanifest" />
	
	<!-- SVG favicon for modern browsers -->
	<link rel="icon" type="image/svg+xml" href="/favicon.svg">

	<!-- Fallback PNG for browsers that don't support SVG -->
	<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">

	<!-- Apple Touch Icon for iOS home screen -->
	<link rel="apple-touch-icon" href="/apple-touch-icon.png">

	<!-- Fallback for older browsers -->
	<link rel="shortcut icon" href="/favicon.ico">

	<!-- Viewport height -->
	<script>
		(function () {
		  function setVH() {
			const vh = window.innerHeight * 0.01;
			document.documentElement.style.setProperty('--vh', `${vh}px`);
		  }
		  document.addEventListener('DOMContentLoaded', setVH);
		  window.addEventListener('orientationchange', () => setTimeout(setVH, 250));
		  if (window.visualViewport) {
			let last = window.visualViewport.height;
			window.visualViewport.addEventListener('resize', () => {
			  const now = window.visualViewport.height;
			  if (now < last - 120) setVH();
			  last = now;
			});
		  }
		})();
	</script>

	<!-- Hamburger / mega menu -->
	<script>
		(function () {
		  const qs  = (sel, root = document) => root.querySelector(sel);
		  const qsa = (sel, root = document) => Array.from(root.querySelectorAll(sel));

		  function trapFocus(container, e) {
			const focusables = qsa('a[href], button:not([disabled]), [tabindex]:not([tabindex="-1"])', container)
			  .filter(el => !el.hasAttribute('inert') && !el.closest('[inert]'));
			if (!focusables.length) return;
			const first = focusables[0], last = focusables[focusables.length - 1];
			if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
			else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
		  }

		  function openMenu(hamburger, menu) {
			document.body.classList.add('menu-open');
			menu.classList.remove('not-active');
			menu.classList.add('is-active');
			hamburger.classList.add('is-active');
			hamburger.setAttribute('aria-expanded', 'true');
			const firstLink = menu.querySelector('a'); if (firstLink) firstLink.focus();
		  }
		  function closeMenu(hamburger, menu, restoreTo) {
			document.body.classList.remove('menu-open');
			menu.classList.remove('is-active');
			menu.classList.add('not-active');
			hamburger.classList.remove('is-active');
			hamburger.setAttribute('aria-expanded', 'false');
			if (restoreTo) restoreTo.focus();
		  }
		  function toggleMenu(hamburger, menu) {
			menu.classList.contains('is-active') ? closeMenu(hamburger, menu, hamburger)
												 : openMenu(hamburger, menu);
		  }

		  document.addEventListener('DOMContentLoaded', () => {
			const hamburger = qs('#hamburger');
			const megaMenu  = qs('#mega-menu');
			if (!megaMenu || !hamburger) return;

			if (!megaMenu.classList.contains('is-active') && !megaMenu.classList.contains('not-active')) {
			  megaMenu.classList.add('not-active');
			}
			hamburger.addEventListener('click', () => toggleMenu(hamburger, megaMenu));

			megaMenu.addEventListener('click', (e) => {
			  const link = e.target.closest('a');
			  if (link) closeMenu(hamburger, megaMenu, hamburger);
			});
			megaMenu.addEventListener('click', (e) => {
			  if (e.target === megaMenu) closeMenu(hamburger, megaMenu, hamburger);
			});

			document.addEventListener('keydown', (e) => {
			  if (!megaMenu.classList.contains('is-active')) return;
			  if (e.key === 'Escape') { e.preventDefault(); closeMenu(hamburger, megaMenu, hamburger); return; }
			  if (e.key === 'Tab') { trapFocus(megaMenu, e); }
			});
		  });
		})();
	</script>

	<!-- Arrow fade on scroll -->
	<script>
		(function () {
		  let ticking = false;
		  const clamp = (n, min, max) => Math.max(min, Math.min(max, n));
		  function onScroll(arrowFade) {
			const y = window.scrollY || window.pageYOffset || 0;
			arrowFade.style.opacity = String(clamp(1 - y / 300, 0, 1));
			ticking = false;
		  }
		  function requestTick(arrowFade) {
			if (!ticking) { ticking = true; requestAnimationFrame(() => onScroll(arrowFade)); }
		  }
		  document.addEventListener('DOMContentLoaded', () => {
			const arrowFade = document.querySelector('.arrow-fade');
			if (!arrowFade) return;
			onScroll(arrowFade);
			window.addEventListener('scroll', () => requestTick(arrowFade), { passive: true });
		  });
		})();
	</script>

	<!-- Logo animation replay (double-click/tap) -->
	<script>
		(function () {
		  function enableLogoReplay() {
			const logo = document.querySelector('.logo');
			if (!logo) return;
			logo.addEventListener('dblclick', () => {
			  const svg = logo.querySelector('svg');
			  if (!svg) return;
			  const clone = svg.cloneNode(true);
			  if (svg.hasAttribute('aria-hidden')) clone.setAttribute('aria-hidden', svg.getAttribute('aria-hidden'));
			  if (svg.hasAttribute('focusable'))   clone.setAttribute('focusable',   svg.getAttribute('focusable'));
			  svg.replaceWith(clone);
			}, { passive: true });
		  }
		  if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', enableLogoReplay);
		  else enableLogoReplay();
		})();
	</script>

	<!-- HAMBURGER COLOR SCROLL TOGGLE -->
	<script>
		(function () {
		  // How many pixels *before* the hero ends the switch should happen
		  const SWITCH_OFFSET = 50; // tweak this number: bigger = earlier switch

		  function setupHamburgerColorSwitch() {
			const hero = document.querySelector('.nav-center-screen');
			if (!hero) return;

			// Create (or reuse) a 1px sentinel inside the hero, positioned up from the bottom.
			let sentinel = hero.querySelector('.hero-sentinel');
			if (!sentinel) {
			  sentinel = document.createElement('div');
			  sentinel.className = 'hero-sentinel';
			  hero.appendChild(sentinel);
			}

			// Inline styles so this works without relying on extra CSS
			Object.assign(sentinel.style, {
			  position: 'absolute',
			  left: '0',
			  right: '0',
			  bottom: `${SWITCH_OFFSET}px`, // move this value by editing SWITCH_OFFSET above
			  height: '1px',
			  pointerEvents: 'none'
			  // For quick debugging, uncomment the next line to *see* the sentinel:
			  // ,background: 'rgba(255,0,0,.3)'
			});

			// Ensure the hero is a positioning context
			const heroComputed = getComputedStyle(hero);
			if (heroComputed.position === 'static') {
			  hero.style.position = 'relative';
			}

			// Observe the sentinel: when it leaves the viewport, we’re past the hero.
			const io = new IntersectionObserver((entries) => {
			  const entry = entries[0];
			  if (entry.isIntersecting) {
				// Sentinel is visible -> we're still within the hero
				document.body.classList.remove('hamburger-on-light');
			  } else {
				// Sentinel scrolled out -> we're into the light section
				document.body.classList.add('hamburger-on-light');
			  }
			}, { threshold: 0 });

			io.observe(sentinel);
		  }

		  if (document.readyState === 'loading') {
			document.addEventListener('DOMContentLoaded', setupHamburgerColorSwitch);
		  } else {
			setupHamburgerColorSwitch();
		  }
		})();
	</script>
</head>
<html lang="en">
	<style>
		:root { 
			--burger: #dcb24c;
			
			/* logo start delays */
			--seg1-start: 0s;
			--seg2-start: 0.71s;
			--seg3-start: 0.9s;
			--seg4-start: 1.33s;
			--seg5-start: 1.75s;

			/* logo stroke durations  */
			--seg1-final-dur: 1.25s;
			--seg2-final-dur: 1s;
			--seg3-final-dur: 0.75s;
			--seg4-final-dur: 0.75s;
			--seg5-final-dur: 0.75s;

			/* logo stroke settings */
			--stroke-w: clamp(10px, 6vw, 47px);
			--c12: #f3f1f1;
			--c34: #4F8ABA;
			--fill-dash: 1.02;  
			--fill-off-start: 1.02; 
			--fill-off-end:  -0.02;
	
			/* Name & Title settings */
			--firstName-delay: 1s;
			--lastName-delay: 1.6s;         
			--fade-dur: 0.75s;
			--title-delay: 2s;
			--subtitle-delay: 2.5s;
			
			/* Page settings */
			--arrow-delay: 3s;
			--hamburger-delay: 3s;
			--below-delay: 3s;
		}
	          

		html { scrollbar-gutter: stable both-edges; }

		body.menu-open { overflow: hidden; }
		body { margin: 0; padding: 0; background-color: #0f273f; }
		a, a:visited, a:active, a:hover { text-decoration: none; }
		*, *:after, *:before { box-sizing: border-box; }

	  	/* Branding utilities */
	  	.off-white { color: #f3f1f1; }
	  	.light-blue { color: #4F8ABA; }
	  	.dark-blue { color: #0f273f; }
	  	.mustard  { color: #dcb24c; }
		.font-mont { font-family: 'Montserrat', sans-serif; }
	  	.font-bitter { font-family: 'Bitter', serif; }
		@keyframes appear { 
			0% {opacity:0;} 
			100% {opacity:1;} 
		}

	  	/* Hamburger */
	  	#hamburger {
			position: fixed; 
			top: 12px; 
			right: 12px; 
			z-index: 4;
			display: inline-flex; 
			flex-direction: column; 
			align-items: center; 
			gap: 6px;
			padding: 10px 12px; 
			cursor: pointer; 
			font: inherit; 
			color: inherit; 
			background: transparent; 
			border: none; 
			margin: 0;
			overflow: visible; 
			transition: opacity 0.15s linear, filter 0.15s linear;
			opacity: 0; 
			-webkit-animation: appear 1s ease-in-out var(--hamburger-delay) forwards; 
			animation: appear 1s ease-in-out var(--hamburger-delay) forwards;
	  	}
	  	#hamburger:focus { 
			outline: 2px solid #dcb24c; 
			outline-offset: 4px; 
		}
	  	#hamburger:hover, #hamburger.is-active:hover { 
			opacity: 0.7; 
		}

	  	.hamburger-box { 
			width: 40px; 
			height: 24px; 
			display: inline-block; 
			position: relative; 
		}
	  	.hamburger-inner { 
			display: block; 
			top: 50%; 
			margin-top: -2px; 
		}
	  	.hamburger-inner,
	  	.hamburger-inner::before,
	  	.hamburger-inner::after {
			width: 40px; 
			height: 4px; 
			background-color: var(--burger); 
			border-radius: 4px; 
			position: absolute;
			transition: transform 0.15s ease 0s, background-color .25s ease 0s;
		}
	  	.hamburger-inner::before, .hamburger-inner::after { 
			content: ""; 
			display: block; 
		}
	  	.hamburger-inner::before { top: -10px; }  
		.hamburger-inner::after  { bottom: -10px; }
	  	.hamburger-label {
			font-family: 'Montserrat', sans-serif; 
			font-weight: 700; 
			text-transform: uppercase; 
			font-size: 12px;
			color: var(--burger);
			transition: color .25s ease 0s; 
		}

	  	.hamburger--spin .hamburger-inner { 
			transition-duration: 0.22s; 
			transition-timing-function: cubic-bezier(0.55,0.055,0.675,0.19); 
		}
	  	.hamburger--spin .hamburger-inner::before { 
			transition: top 0.1s 0.25s ease-in, opacity 0.1s ease-in, background-color .25s ease 0s, transform 0.15s ease 0s; 
		}
	  	.hamburger--spin .hamburger-inner::after  { 
			transition: bottom 0.1s 0.25s ease-in, transform 0.22s cubic-bezier(0.55,0.055,0.675,0.19), background-color .25s ease 0s; 
		}
	  	.hamburger--spin.is-active .hamburger-inner { 
			transform: rotate(225deg); 
			transition-delay: 0.12s; 
			transition-timing-function: cubic-bezier(0.215,0.61,0.355,1); 
		}
	  	.hamburger--spin.is-active .hamburger-inner::before { 
			top: 0; 
			opacity: 0; 
			transition: top 0.1s ease-out, opacity 0.1s 0.12s ease-out; 
		}
	  	.hamburger--spin.is-active .hamburger-inner::after  { 
			bottom: 0; 
			transform: rotate(-90deg); 
			transition: bottom 0.1s ease-out, transform 0.22s 0.12s cubic-bezier(0.215,0.61,0.355,1); 
		}

	  	#hamburger.is-active .hamburger-inner,
	  	#hamburger.is-active .hamburger-inner::before,
	  	#hamburger.is-active .hamburger-inner::after { 
			background-color: #f3f1f1 !important; 
		}
	  	#hamburger.is-active .hamburger-label { color: #f3f1f1 !important; }

		/** HAMBURGER COLOR CHANGE **/
		body.hamburger-on-light { --burger: #0f273f; } 
	  	body.hamburger-on-light #hamburger .hamburger-label {transition: color .25s ease 0ms;}
	  	body.hamburger-on-light #hamburger .hamburger-inner::after {transition: transform 0.15s ease 0s, background-color .25s ease 80ms;}
	  	body.hamburger-on-light #hamburger .hamburger-inner {transition: transform 0.15s ease 0s, background-color .25s ease 160ms; }
	  	body.hamburger-on-light #hamburger .hamburger-inner::before {transition: transform 0.15s ease 0s, background-color .25s ease 240ms;}

	  	body:not(.hamburger-on-light) #hamburger .hamburger-inner::before {transition: transform 0.15s ease 0s, background-color .25s ease 0ms;}
	  	body:not(.hamburger-on-light) #hamburger .hamburger-inner {transition: transform 0.15s ease 0s, background-color .25s ease 80ms;}
	  	body:not(.hamburger-on-light) #hamburger .hamburger-inner::after {transition: transform 0.15s ease 0s, background-color .25s ease 160ms;}
	  	body:not(.hamburger-on-light) #hamburger .hamburger-label {transition: color .25s ease 240ms;}

		.hero-sentinel { 
			position: absolute; 
			left: 0; 
			right: 0; 
			bottom: 0;
			height: 1px; 
			pointer-events: none; 
		}

		/* Menu overlay */
		#mega-menu {
			position: fixed; 
			inset: 0; 
			background-color: #0f273f; 
			padding: 76px; 
			z-index: 3;
			opacity: 0; 
			pointer-events: none; 
			transform: translateZ(0) scale(1.03);
			transition: opacity .35s ease, transform .35s ease; 
			will-change: opacity, transform;
		}
		#mega-menu.is-active { 
			opacity: 1; 
			pointer-events: auto; 
			transform: none; 
		}
		#mega-menu.not-active { 
			opacity: 0; 
			pointer-events: none; 
			transform: translateZ(0) scale(1.03); 
		}

		.menu-item {
			display: block; 
			text-transform: capitalize; 
			font-family: 'Bitter', serif; 
			font-weight: 400; 
			font-style: italic;
			color: #dcb24c; 
			font-size: clamp(24px, 8vw, 64px); 
			margin-bottom: 6%; 
			text-align: left; 
			width: 100%;
			border-bottom: 2px solid #f3f1f1; outline: none;
		}
		.menu-item:focus-visible {
			outline: 2px solid #f3f1f1; 
			outline-offset: 4px; 
		}

		/* TITLE SCREEN */
		.nav-center-screen {
			width: 100%;
			display: flex; 
			flex-direction: column; 
			justify-content: center; 
			align-items: center;
			text-align: center; 
			background-color: #0f273f; 
			overflow: hidden; 
			position: relative; 
			margin: 0 auto;
			border-bottom: 10px solid rgba(90,145,191,0);
			height: calc(100svh - env(safe-area-inset-bottom, 0px));
			padding-bottom: env(safe-area-inset-bottom, 0px);
		}
		@supports not (height: 100svh) {
			.nav-center-screen { 
				height: calc(var(--vh, 1vh) * 100); 
				padding-bottom: 0; 
			}
		}
		
		/** NAME **/
		.logo-name { 
			font-size: clamp(32px, 7.5vw, 85px); 
			letter-spacing: 1.2; 
			line-height: 0.9; 
			font-weight: 600; 
			text-transform: uppercase; 
			margin: 0.5% auto; 
			text-align: center;
		}
		.first-name {
			opacity: 0;
			animation: appear var(--fade-dur) ease-in var(--firstName-delay) forwards;
		}
		.last-name {
			opacity: 0;
			animation: appear var(--fade-dur) ease-in var(--lastName-delay) forwards;
		}
		
		/** TITLE **/
		.logo-title {
			font-size: clamp(14px, 3.25vw, 25px); 
			line-height: 1.2; 
			letter-spacing: 2; 
			font-weight: 400; 
			font-style: italic; 
			text-transform: capitalize; 
			text-align: center;
			opacity: 0; 
			animation: appear var(--fade-dur) ease-in var(--title-delay) forwards;
		}
		.logo-subtitle {
			font-size: clamp(14px, 3.25vw, 25px); 
			line-height: 1.2; 
			letter-spacing: 2; 
			font-weight: 400; 
			font-style: italic; 
			text-transform: capitalize; 
			text-align: center;
			opacity: 0; 
			animation: appear var(--fade-dur) ease-in var(--subtitle-delay) forwards;
		}

		/** ARROW **/
		.arrow { 
			position: absolute; 
			bottom: 0; 
			left: 50%; 
			margin-left: -20px; 
			width: 40px; 
			height: 40px; 
			opacity: 0;
			animation:
			bounce 2s infinite,
			appear var(--fade-dur) ease-in var(--arrow-delay) forwards;
		}
		.arrow svg { 
			width: 40px; 
			height: 40px; 
			display: block; 
		}
		.arrow path { fill: #f3f1f1; }
		@keyframes bounce { 
			0%,20%,50%,80%,100% {transform: translateY(0);} 
			40% {transform: translateY(-25px);} 
			60% {transform: translateY(-15px);} 
		}
		
		/** BELOW **/
		.below { 
			height: 0; 
			overflow: hidden; 
			background-color: #f3f1f1; 
			animation: showcontent 0s ease-in var(--below-delay) forwards; 
		}
		@keyframes showcontent { 100% { height: auto; } }

		/** PORTFOLIO STYLES **/
		.work-wrapper { 
			width: 100%; margin: 0 auto; display: flex; flex-direction: row; flex-wrap: wrap; justify-content: space-evenly; margin-top: 5%; 
		}
		.work-item { 
			width: 80%; 
			margin-bottom: 9%; 
		}
		.portfolio-info { 
			width: 100%; 
			text-align: left; 
			padding: 2% 0% 4%; 
		}
		.portfolio-info::before { 
			content: ""; 
			display: block; 
			position: relative; 
			top: 0; 
			right: 0; 
			height: 2px; 
			background: #dcb24c; 
			width: 50%;
		}
		.project-name { 
			font-family: 'Montserrat', sans-serif; 
			font-weight: 600; 
			text-transform: uppercase; 
			letter-spacing: 1; 
			color: #3D729E; 
			font-size: clamp(18px, 3.75vw, 22px); 
			margin-top: 2%; 
		}
		.project-role { 
			text-transform: capitalize; 
			font-family: 'Bitter', serif; 
			font-weight: 400; 
			font-style: italic; 
			color: #0f273f; 
			font-size: clamp(12px, 2.5vw, 14.66px); 
			letter-spacing: 2; 
		}

		@media (max-width: 767px) { 
			#mega-menu { padding: 76px 30px; } 
			.menu-item { margin-bottom: 12%; }
		}
		@media (min-width: 768px) {
			.work-item { 
				width: 45%; 
				margin-bottom: 3%; 
			}
			.project-name { 
				font-size: clamp(18px, 1.75vw, 22px); 
			}
			.project-role { 
				font-size: clamp(12px, 1.25vw, 14.66px); 
				letter-spacing: 1.5; 
			}
			.menu-item { 
				font-size: clamp(28px, 4.5vw, 64px); 
			}
		}
		@media (min-width: 1024px) { 
			.work-item { width: 28%; } 
		}
		
		/** LOGO **/
		.logo {
			display: inline-block;
			width: clamp(200px, 60vw, 420px);
			max-width: 100%;
			overflow: hidden;
			user-select: none; -webkit-user-select: none;
			cursor: pointer;
		}
		.logo svg { width: 100%; height: 100%; display: block; }

		.draw-final{
			fill: none;
			stroke-width: var(--stroke-w);
			stroke-linecap: round;
			stroke-linejoin: round;
			stroke: currentColor;

			/* IMPORTANT: single-pass reveal uses a *fixed* solid dash length.
			   We only animate the *offset* (no moving “snake” head/tail). */
			stroke-dasharray: var(--fill-dash);
			stroke-dashoffset: var(--fill-off-start);
			visibility: hidden;

			will-change: stroke-dashoffset, visibility;
			shape-rendering: geometricPrecision;
		}

		.seg1 { color: var(--c12); }
		.seg2 { color: var(--c12); }
		.seg3 { color: var(--c34); }
		.seg4 { color: var(--c34); }
		.seg5 { color: var(--c34); }

		@keyframes reveal { to { visibility: visible; } }

		@keyframes draw-once {
			0%   { stroke-dashoffset: var(--fill-off-start); }
			100% { stroke-dashoffset: var(--fill-off-end); }
		}

		.seg1.draw-final {
			animation:
				reveal    0s step-end var(--seg1-start) forwards,
				draw-once var(--seg1-final-dur) ease var(--seg1-start) forwards;
		}
		.seg2.draw-final {
			animation:
				reveal    0s step-end var(--seg2-start) forwards,
				draw-once var(--seg2-final-dur) ease var(--seg2-start) forwards;
		}
		.seg3.draw-final {
			animation:
				reveal    0s step-end var(--seg3-start) forwards,
				draw-once var(--seg3-final-dur) ease var(--seg3-start) forwards;
		}
		.seg4.draw-final {
			animation:
				reveal    0s step-end var(--seg4-start) forwards,
				draw-once var(--seg4-final-dur) ease var(--seg4-start) forwards;
		}
		.seg5.draw-final {
			animation:
				reveal    0s step-end var(--seg5-start) forwards,
				draw-once var(--seg5-final-dur) ease var(--seg5-start) forwards;
		}

		@media (orientation: landscape) and (max-height: 480px) {
			.nav-center-screen { 
				padding-top: 2vh; 
				padding-bottom: 2vh; 
			}
			.logo { 
				max-height: min(42vh, 44svh); 
				width: auto; 
			}
			.logo-name { 
				font-size: clamp(24px, 6vh, 48px); 
			}
			.logo-title { 
				font-size: clamp(12px, 3.5vh, 20px); 
			}
			.logo-subtitle { 
				font-size: clamp(12px, 3.5vh, 20px); 
			}
			.arrow { 
				transform: scale(0.85); 
				transform-origin: center bottom; 
			}
		}
	</style>
	<style>
  :root{
    --gap: 40px;
    --overlay-dim: rgba(0,0,0,0);
    --shadow: 0 8px 24px rgba(0,0,0,.18);
    --tile-bg: #f3f1f1;

    /* Tiles (exit stagger) */
    --stagger-shift: 175px;
    --stagger-dur: .58s;
    --stagger-step: .05s;
    --stagger-ease: ease;

    /* Panels (stage) */
    --stage-delay: calc(var(--stagger-dur) + (var(--stagger-step) * 2)); /* img + title + role */
    --stage-in-dur: .5s;
    --stage-out-dur: .45s;
    --stage-ease: ease;
    --right-gap: .15s;
    --panel-bg: #0f273f;
    --panel-fg: #f3f1f1;
    --stage-shadow: none;

    /* Tile re-entry */
    --tile-in-dur: .35s;
    --tile-in-ease: cubic-bezier(.16,.84,.44,1);
    --tile-base-delay: calc(var(--tile-in-dur) - .15s);
    --tile-entry-offset: 10px;

    /* Interaction */
    --hover-lift: -2px;
    --hover-shadow: var(--shadow);
    --focus-outline: 2px solid #000;
    --focus-offset: 3px;

    /* Overlay behavior */
    --stage-edge: 16px;                  /* visible edge margin */
    --stage-max-h: calc(100vh - 32px);   /* 2 * edge */
    --stack-break: 900px;                /* stack panels ≤ 900px */
  }

  /* Base */
  html, body { height: 100%; background: #f3f1f1; }
  html { box-sizing: border-box; }
  *, *::before, *::after { box-sizing: inherit; }
  body { margin:0; color:#111; font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }

  /* ===== BOX / GRID ===== */
  .container { width: 100%; }
  .box { position: relative; width: 95%; margin: 40px auto; }

  .box__row { display:flex; flex-wrap:wrap; gap:var(--gap); transition: visibility .001s linear; }
  .box__row.is-hidden { visibility: hidden; }

  .box__row-cell {
    position:relative;
    background: var(--tile-bg, #ffffff);
    overflow:hidden; cursor:pointer;
    transition:
      transform .2s ease,
      box-shadow .25s ease,
      opacity .25s ease,
      background-color var(--stagger-dur) var(--stagger-ease);
    outline:none; flex:1 1 100%;
    max-width: 100%;
  }
  .box__row-cell:focus-visible { outline: var(--focus-outline); outline-offset: var(--focus-offset); }
  .box__row-cell:hover { transform: translateY(var(--hover-lift)); box-shadow: var(--hover-shadow); }

  @media (min-width:700px){
    .box__row-cell{ flex-basis: calc(50% - var(--gap)); max-width: calc(50% - var(--gap)); }
  }
  @media (min-width:1024px){
    .box__row-cell{ flex-basis: calc(33% - var(--gap)); max-width: calc(33% - var(--gap)); }
  }
  @media (min-width:1400px){
    .box__row-cell{ flex-basis: calc(25% - var(--gap)); max-width: calc(25% - var(--gap)); }
  }

  .tile__img { display:block; width:100%; height:auto; aspect-ratio:495/350; object-fit:cover; }
  .tile__meta { background:var(--tile-meta-bg); text-align:left; padding: 2% 5% 4%; }
  .tile__meta::before { content:""; display:block; position:relative; top:0; right:0; height:2px; background:#dcb24c; width:50%; }

  .tile__title {
    font-family:'Montserrat',sans-serif; font-weight:600; text-transform:uppercase; letter-spacing:1px;
    color:#3D729E; font-size:clamp(18px, 3.75vw, 22px); margin: 2% 0 1%;
  }
  .tile__role{
    text-transform:capitalize; font-family:'Bitter',serif; font-weight:400; font-style:italic;
    color:#0f273f; font-size:clamp(12px, 2.5vw, 14.66px); letter-spacing:2px; margin:0;
  }

  /* Hover-dim others */
  .box__row.is-hover .box__row-cell::after { content:""; position:absolute; inset:0; background:var(--overlay-dim); }
  .box__row.is-hover .box__row-cell.is-hovered::after { opacity:0; background:transparent; }

  /* Fade all except source on click */
  .box__row.is-fading .box__row-cell { opacity:0; pointer-events:none; }
  .box__row.is-fading .box__row-cell.is-source { opacity:1; pointer-events:auto; }

  /* ===== Stagger-out on source tile ===== */
  .stagger-out .tile__img,
  .stagger-out .tile__meta::before,
  .stagger-out .tile__title,
  .stagger-out .tile__role {
    will-change: transform, opacity;
    transition: transform var(--stagger-dur) var(--stagger-ease), opacity var(--stagger-dur) var(--stagger-ease);
  }
  .stagger-out.run .tile__img   { transform: translateX(var(--stagger-shift)); opacity:0; transition-delay:0s; }
  .stagger-out.run .tile__meta::before { transform: translateX(var(--stagger-shift)); opacity:0; transition-delay: calc(var(--stagger-step)); }
  .stagger-out.run .tile__title { transform: translateX(var(--stagger-shift)); opacity:0; transition-delay: calc(var(--stagger-step) * 2); }
  .stagger-out.run .tile__role  { transform: translateX(var(--stagger-shift)); opacity:0; transition-delay: calc(var(--stagger-step) * 3); }

  .box__row-cell.stagger-out {
    transition:
      transform .2s ease,
      box-shadow var(--stagger-dur) var(--stagger-ease),
      opacity .25s ease,
      background-color var(--stagger-dur) var(--stagger-ease);
  }
  .box__row-cell.stagger-out:hover { box-shadow: none; transform: none; }
  .box__row-cell.stagger-out.run { box-shadow: none; background-color: transparent; }
  .box__row.is-fading .box__row-cell.is-source:hover { box-shadow: none; transform: none; }

  /* ===== CSS re-entry animation ===== */
  @keyframes tileIn {
    from { opacity: 0; transform: translateY(var(--tile-entry-offset)); }
    to   { opacity: 1; transform: translateY(0); }
  }
  .box__row.is-revealing .box__row-cell {
    will-change: opacity, transform;
    animation: tileIn var(--tile-in-dur) var(--tile-in-ease) both;
    animation-delay: calc(var(--i, 0) * var(--tile-base-delay));
  }

  /* ===== STAGE OVERLAY ===== */
  .stage {
    position: absolute;
    top: var(--gap);
    left: var(--gap);
    right: var(--gap);
    display: none;
    z-index: 10;
    grid-template-columns: 3fr 1fr; /* desktop 75/25 */
    gap: 0;
    align-items: stretch;
    overflow: hidden;
    pointer-events: none;
  }
  .stage.is-open { display: grid; box-shadow: var(--stage-shadow); }
  /* Fixed mode: clamp to viewport, always visible */
  .stage.is-open.is-fixed {
    position: fixed;
    inset: auto; /* we’ll set top/left/right via inline styles */
    max-height: var(--stage-max-h);
    pointer-events: none;
  }
  /* LEFT: SC carousel lives here */
  .stage__left {
    pointer-events: auto;
    aspect-ratio: 495 / 350;
    transform: translateX(-101%); /* desktop entry */
    position: relative;
    overflow: hidden;
    background: #fff;
  }

  /* ===== SC CAROUSEL (unchanged mechanics) ===== */
  .sc { position: relative; width: 100%; height: 100%; }
  .sc__viewport { position: relative; overflow: hidden; touch-action: pan-y; background-color: #fff; height: 100%; }
  .sc__track { display: flex; transition: transform .4s ease; will-change: transform; user-select: none; cursor: grab; height: 100%; transform: translateX(0%); }
  .sc__track.is-dragging { cursor: grabbing; }
  .sc__slide { min-width: 100%; height: 100%; display: grid; place-items: center; }
  .sc__media { display: block; width: 100%; height: 100%; }
  .sc img { -webkit-user-drag: none; user-select: none; max-width: 100%; max-height: 100%; object-fit: contain; width: 100%; }

  .sc__nav {
    position: absolute; top: 0; bottom: 0; width: 48px; border: 0;
    color: #0f273f; font-size: 28px; line-height: 1; cursor: pointer; background: transparent;
  }
  .sc__nav--prev { left: 0; }
  .sc__nav--next { right: 0; }

  .sc__controls { position: absolute; left: 0; bottom: 0; padding: 10px 14px; min-height: 56px; color: #0f273f; display: flex; align-items: center; gap: 10px; justify-content: center; }
  .sc__dots { display: inline-flex; gap: 8px; }
  .sc__dot { width: 8px; height: 8px; border-radius: 999px; border: 0; padding: 0; background: rgba(15,39,63,.45); cursor: pointer; }
  .sc__dot[aria-selected="true"] { background: #0f273f; transform: scale(1.2); }

  .sc__toggle {
    background: transparent; border: 1px solid rgba(15,39,63,1);
    color: #0f273f; border-radius: 999px; padding: 6px 10px; font-size: 12px; cursor: pointer;
  }
  .sc__toggle::before { content: '❚❚'; margin-right: 6px; font-size: 12px; }
  .sc__toggle[aria-pressed="false"]::before { content: '►'; }

  /* RIGHT PANEL */
  .stage__right {
    pointer-events: auto;
    position: relative;
    background: var(--panel-bg);
    color: var(--panel-fg);
    padding: 18px 18px 24px 18px;
    transform: translateX(101%); /* desktop entry */
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    overflow: auto;                        /* allow scroll if content long */
    -webkit-overflow-scrolling: touch;
  }

  /* Desktop slide-in/out */
  .stage.is-open .stage__left  { animation: slideInLeft  var(--stage-in-dur) var(--stage-ease) forwards;  animation-delay: var(--stage-delay); }
  .stage.is-open .stage__right { animation: slideInRight var(--stage-in-dur) var(--stage-ease) forwards;  animation-delay: calc(var(--stage-delay) + var(--right-gap)); }
  @keyframes slideInLeft  { from { transform: translateX(-101%); } to { transform: translateX(0); } }
  @keyframes slideInRight { from { transform: translateX(101%);  } to { transform: translateX(0); } }

  .stage.is-closing .stage__left  { animation: slideOutLeft  var(--stage-out-dur) var(--stage-ease) forwards; }
  .stage.is-closing .stage__right { animation: slideOutRight var(--stage-out-dur) var(--stage-ease) forwards; }
  .stage.is-closing .stage__close { opacity: 0; pointer-events:none; transition: opacity .2s ease; }
  @keyframes slideOutLeft  { from { transform: translateX(0); } to { transform: translateX(-101%); } }
  @keyframes slideOutRight { from { transform: translateX(0); } to { transform: translateX(101%); } }

  /* Mobile/tablet stacked layout ≤ 900px */
  @media (max-width: 900px){
    .stage { grid-template-columns: 1fr; grid-template-rows: auto auto; }
    .stage__left, .stage__right { transform: translateY(-101%); } /* initial off-top */
    /* Replace desktop side slides with top-down drops */
    .stage.is-open .stage__left  { animation: dropIn  var(--stage-in-dur) var(--stage-ease) forwards; animation-delay: var(--stage-delay); }
    .stage.is-open .stage__right { animation: dropIn  var(--stage-in-dur) var(--stage-ease) forwards; animation-delay: calc(var(--stage-delay) + var(--right-gap)); }
    .stage.is-closing .stage__left  { animation: dropOut var(--stage-out-dur) var(--stage-ease) forwards; }
    .stage.is-closing .stage__right { animation: dropOut var(--stage-out-dur) var(--stage-ease) forwards; }
  }
  @keyframes dropIn  { from { transform: translateY(-101%); } to { transform: translateY(0); } }
  @keyframes dropOut { from { transform: translateY(0); }      to { transform: translateY(-101%); } }

  /* Typography in panel */
  .panel__title {
    margin:0 0 8px; font-family:'Montserrat',sans-serif; font-weight:600;
    font-size:clamp(18px, 3.75vw, 22px); text-transform:uppercase; letter-spacing:1px; color:#f3f1f1;
  }
  .panel__role  {
    margin:0 0 10px; text-transform:capitalize; font-family:'Bitter',serif; font-weight:400; font-style:italic;
    font-size:clamp(12px,2.5vw,14.66px); letter-spacing:2px; color:#f3f1f1;
  }
  .panel__desc  { margin:0; font:400 14px/1.6 system-ui; color:#f3f1f1; }

  .panel__links { margin: 12px 0 0; display:flex; gap:10px; flex-wrap:wrap; }
  .panel__link  { display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; background:#2a2d32; color:#f3f1f1; text-decoration:none; font-size:13px; }
  .panel__tags  { margin:12px 0 0; display:flex; flex-wrap:wrap; gap:6px; }
  .panel__tag   { font-size:12px; padding:4px 8px; background:#dcb24c; border-radius:999px; color:#0f273f; }

  /* Close button */
  .stage__close {
    position: absolute; top: 10px; right: 10px; width: 36px; height: 36px;
    border: 0; background: transparent; cursor: pointer; padding: 0;
  }
  .stage__close .inner { position: relative; width: 100%; height: 100%; text-align: center; }
  .stage__close .label { display:block; font-size:.8em; line-height:36px; text-transform:uppercase; color:#f3f1f1; transition: all .3s ease-in; opacity:0; pointer-events:none; }
  .stage__close .inner::before, .stage__close .inner::after { content:''; position:absolute; right:0; width:200%; height:1px; background:#FFC107; transition: all .3s ease-in; }
  .stage__close .inner::before { top:50%;  transform:rotate(45deg); }
  .stage__close .inner::after  { bottom:50%; transform:rotate(-45deg); }
  .stage__close:hover .label { opacity:1; }
  .stage__close:hover .inner::before, .stage__close:hover .inner::after { transform: rotate(0); }
  .stage__close:hover .inner::before { top:0; }
  .stage__close:hover .inner::after  { bottom:0; }
  .stage__close:focus-visible { outline: 2px solid #fff; outline-offset: 3px; }

  @media (prefers-reduced-motion: reduce) {
    .stagger-out .tile__img, .stagger-out .tile__title, .stagger-out .tile__role { transition: none !important; }
    .stage.is-open .stage__left, .stage.is-open .stage__right, .stage.is-closing .stage__left, .stage.is-closing .stage__right {
      animation: none !important; transform: translateX(0) !important;
    }
    .box__row.is-revealing .box__row-cell { animation: none !important; opacity: 1 !important; transform: none !important; }
    .sc__track { transition: none !important; }
  }
</style>	

	<div class="page">
		<button id="hamburger" class="hamburger--spin js-hamburger" aria-controls="mega-menu" aria-expanded="false" aria-label="Main menu">
			<span class="hamburger-box" aria-hidden="true"><span class="hamburger-inner"></span></span>
			<span class="hamburger-label">Menu</span>
		</button>

		<div class="nav-center-screen">
			<div id="hero-sentinel" class="hero-sentinel" aria-hidden="true"></div>

			<div class="w-100 text-center">
				<div class="logo">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500" preserveAspectRatio="xMidYMid meet" aria-hidden="true" focusable="false">
						<defs>
							<!-- Centerline paths -->
							<path id="p1" pathLength="1" d="M161.6,181.1c0,0,40.3-38.4,40.3-38.4c72.8,324.2-76.5,356.7-121.3,292.8" />
							<path id="p2" pathLength="1" d="M115.7,460.3C43.3,440.8,12,289.5,340.1,197" />
							<path id="p3" pathLength="1" d="M228.4,215.5C461,62.8,323-44.6,274.8,94.2c-4.9,14.1-8.9,30.7-11.4,50.1" />
							<path id="p4" pathLength="1" d="M269.2,113.3c-2.9,11.7-5.2,24.7-6.8,39.2c-12.4,115.2,11.2,229.5-34,258.3" />
							<path id="p5" pathLength="1" d="M178.7,405.7c-17-19.6-21.3-44.3-8.8-66.7c45.2-78.7,232-85.4,289.7-70.9" />

							<!-- Outline clips -->
							<path id="op1" d="M228.4,245c-0.7-5.4-1.5-10.8-2.4-16.1c-5.3-32.6-12.8-62.9-20-87l-2.2-7.4l-4.9,5.3c-12,13-25.7,28.1-37.4,41.5  c11.9-9.5,25.2-20.3,37.3-30.4c4.3,28.3,7.8,56.6,9.8,85c0.4,6.4,0.8,12.7,1.1,19.1c0.6,13.5,0.7,26.9,0.4,40.4  c-0.9,32.3-4.8,66.1-16.4,96.2c-9.8,25.7-30,54.1-59.1,55.9c-17.8,1.2-33.7-8.1-43-22.1l0,0c-0.2-0.1-10.4-2.6-17.4,4.4  c-7,7-4.6,16.1-4.6,16.2l0,0c2.6,3.5,5.6,6.9,8.9,10.1c27.7,27.1,71.3,28.4,101.4,4.5C234.8,416.2,239.4,325.8,228.4,245z" />
							<path id="op2" d="M289.8,208.4c-19.9,5.3-41.7,12-63.7,20.4c-5.8,2.2-11.6,4.5-17.4,6.9c-61.6,25.7-122,64.5-146.4,120.6   c-14.5,33-10.9,73.7,16.2,99.4c8.8,8.6,19.2,14.6,30.2,18l14.1-27.2c-22.1-4.3-38.8-24.7-39.8-48.1   c-1.2-61.8,68.4-111.8,126.7-143.7c6.4-3.5,12.7-6.8,18.7-9.9c6-3,11.7-5.9,17.1-8.4c30.7-14.6,62.4-27.2,94.5-39.5   C323.2,200.2,306.4,204,289.8,208.4z" />
							<path id="op3" d="M365.3,31.6c-9.6-14.4-27.7-19.1-43.7-14.4c-20.9,6-36.2,23.2-46.8,41c-15,25.9-22.1,55.5-25.5,85c0,0,3.4,7.4,13.3,8.4  s15-6.4,15-6.4c5-32.1,14.2-63.7,33.4-86.5c11-13,33.5-24.9,34.9,1c0.5,23.7-15.3,48.9-29.4,67.9c-12.8,17-27.3,32.4-42.5,47.1  c-9,8.7-18.3,17.1-27.8,25.3c-5.9,5.2-11.9,10.3-17.8,15.4c6-3,11.9-6.1,17.8-9.4c9-5,17.9-10.3,26.5-16  c21.6-14.2,41.8-30.5,59.5-49.2c20.3-22.3,39.8-49.5,40.9-81.4C373.2,49.9,371.1,40,365.3,31.6z" />
							<path id="op4" d="M254.8,110.4c-4.2,18.2-6.4,36.8-7.4,55.1c-0.7,11.5-1.1,23.1-1.2,34.6c0,2,0,4,0,6c0,14.9,0.3,29.7,0.9,44.5  c1,35.1,4.3,69.5,2.3,104.3c-1.6,20-4.5,42.4-20.9,55.9c19.8-10.2,27.2-34.1,31.6-54.4c4.3-21,5.9-42.3,7.2-63.6  c1.5-26.6,2.4-57.2,4.1-83.8c0.4-6.1,0.8-12.4,1.3-18.9c0.4-5,0.8-10.1,1.3-15.3c1.8-19.4,4.6-39.6,9.6-58.6L254.8,110.4z" />
							<path id="op5" d="M178.7,405.7c-22.2-13.3-31.9-41.7-23.2-66.4c6.7-19.4,22.9-35.5,39.7-46.5c34.1-21.4,80.3-31.2,119.7-34.8   c40.5-3.2,81.2-2.6,121.2,4.3c7.9,1.5,15.8,3.2,23.5,5.7c-7.9-1.4-15.9-1.9-23.8-2.2c-63.8-1.8-148.8,11.4-205.4,40.6   c-23.3,12.7-49.4,30.1-57.1,56.2C169.4,376.4,172.9,392.4,178.7,405.7L178.7,405.7z" />

							<clipPath id="clip1" clipPathUnits="userSpaceOnUse"><use href="#op1"/></clipPath>
							<clipPath id="clip2" clipPathUnits="userSpaceOnUse"><use href="#op2"/></clipPath>
							<clipPath id="clip3" clipPathUnits="userSpaceOnUse"><use href="#op3"/></clipPath>
							<clipPath id="clip4" clipPathUnits="userSpaceOnUse"><use href="#op4"/></clipPath>
							<clipPath id="clip5" clipPathUnits="userSpaceOnUse"><use href="#op5"/></clipPath>
						</defs>

						<!-- Hidden until each segment’s reveal; no start flash, no endpoint flicker -->
						<g style="shape-rendering:geometricPrecision">
							<g clip-path="url(#clip1)"><use href="#p1" class="draw-final seg1"/></g>
							<g clip-path="url(#clip2)"><use href="#p2" class="draw-final seg2"/></g>
							<g clip-path="url(#clip3)"><use href="#p3" class="draw-final seg3"/></g>
							<g clip-path="url(#clip4)"><use href="#p4" class="draw-final seg4"/></g>
							<g clip-path="url(#clip5)"><use href="#p5" class="draw-final seg5"/></g>
						</g>
					</svg>
				</div>
			</div>

			<div class="logo-name font-mont">
				<span class="first-name off-white">Jonathan</span>
				<span class="last-name light-blue">Legiadre</span>
			</div>

			<div class="logo-title font-bitter mustard">
				<!--Graphic Designer + Front-End Developer-->
				<span class=""></span>
				Designer <span class="">+</span> Developer <span class="">+</span> Brand Builder
			</div>
			<div class="logo-subtitle font-bitter mustard">
				From Print to Pixel
			</div>

			<div class="arrow-fade">
				<div class="arrow" aria-hidden="true">
					<svg viewBox="0 0 24 24" focusable="false" aria-hidden="true">
						<path d="M12 16a1 1 0 0 1-.7-.29l-7-7a1 1 0 1 1 1.4-1.42L12 13.59l6.3-6.3a1 1 0 1 1 1.4 1.42l-7 7A1 1 0 0 1 12 16z"/>
					</svg>
				</div>
			</div>
		</div>

		<nav id="mega-menu" aria-label="Primary">
			<a class="menu-item" href="#work">Work</a>
			<a class="menu-item" href="#about">About</a>
			<a class="menu-item" href="#contact">Contact</a>
		</nav>

		<div class="below">
			<div id="work"></div>
				<div class="container">
				  <div class="box" id="box">
					<!-- Grid populated from JSON -->
					<div class="box__row" id="grid" role="list" aria-live="polite"></div>

					<!-- Stage overlay -->
					<div class="stage" id="stage" aria-live="polite">
					  <section class="stage__left" id="stageLeft" aria-hidden="true"></section>
					  <aside class="stage__right" id="stageRight" role="dialog" aria-modal="true" aria-label="Project details">
						<h2 class="panel__title" id="panelTitle">Title</h2>
						<p class="panel__role" id="panelRole"></p>
						<p class="panel__desc" id="panelDesc"></p>
						<div class="panel__links" id="panelLinks" hidden></div>
						<div class="panel__tags" id="panelTags" hidden></div>
					  </aside>
					</div>
				  </div>
				</div>			
			<div id="about"></div>
			<div id="contact"></div>
		</div>
	</div>
	<script>
(function(){
  var DATA_URL = '/assets/portfolio.json'; // JSON path

  var box        = document.getElementById('box');
  var grid       = document.getElementById('grid');
  var stage      = document.getElementById('stage');
  var stageLeft  = document.getElementById('stageLeft');
  var stageRight = document.getElementById('stageRight');
  var panelTitle = document.getElementById('panelTitle');
  var panelRole  = document.getElementById('panelRole');
  var panelDesc  = document.getElementById('panelDesc');
  var panelLinks = document.getElementById('panelLinks');
  var panelTags  = document.getElementById('panelTags');

  var tiles = [];
  var items = [];
  var lastSourceTile = null;
  var animating = false;
  var repositionHandlersBound = false;

  /* CSS var readers */
  function cssMs(name, fallback){
    var raw = getComputedStyle(document.documentElement).getPropertyValue(name).trim();
    if(!raw) return fallback;
    if(raw.endsWith('ms')) return parseFloat(raw);
    if(raw.endsWith('s'))  return parseFloat(raw)*1000;
    var n = parseFloat(raw);
    return isNaN(n) ? fallback : n;
  }
  function cssPx(name, fallback){
    var raw = getComputedStyle(document.documentElement).getPropertyValue(name).trim();
    if(!raw) return fallback;
    var n = parseFloat(raw);
    return isNaN(n) ? fallback : n;
  }
  function readTimings(){
    return {
      staggerDur:   cssMs('--stagger-dur',  580),
      staggerStep:  cssMs('--stagger-step',  50),
      stageIn:      cssMs('--stage-in-dur',  500),
      stageOut:     cssMs('--stage-out-dur', 450),
      rightGap:     cssMs('--right-gap',     150),
      tileInDur:    cssMs('--tile-in-dur',   350)
    };
  }

  /* Load JSON -> render tiles */
  async function loadData(){
    try {
      const res = await fetch(DATA_URL, { cache:'no-store' });
      if (!res.ok) throw new Error('HTTP '+res.status);
      items = await res.json();
    } catch (e) {
      console.warn('Could not fetch /assets/portfolio.json', e);
      items = [];
    }
    renderTiles(items);
  }

  function renderTiles(list){
    grid.innerHTML = '';
    list.forEach(function(item, i){
      var art = document.createElement('article');
      art.className = 'box__row-cell';
      art.setAttribute('role','listitem');
      art.setAttribute('tabindex','0');
      art.dataset.index = i;
      art.style.setProperty('--i', i);

      var img = document.createElement('img');
      img.className = 'tile__img';
      img.src = item.cover || (item.gallery && item.gallery[0]) || '';
      img.alt = (item.title || 'Project') + ' preview';
      img.loading = 'lazy';
      img.decoding = 'async';

      var meta = document.createElement('div'); meta.className = 'tile__meta';
      var h3 = document.createElement('h3'); h3.className = 'tile__title'; h3.textContent = item.title || 'Untitled';
      var p = document.createElement('p');  p.className = 'tile__role';   p.textContent = item.role || '';

      meta.appendChild(h3); meta.appendChild(p);
      art.appendChild(img); art.appendChild(meta);
      grid.appendChild(art);
    });

    tiles = Array.prototype.slice.call(grid.querySelectorAll('.box__row-cell'));
    grid.addEventListener('mouseover', onHoverOver);
    grid.addEventListener('mouseout', onHoverOut);

    tiles.forEach(function(tile){
      tile.addEventListener('click', function(){ openFrom(tile); });
      tile.addEventListener('keydown', function(e){
        var k = e.key || e.code;
        if (k === 'Enter' || k === ' ' || k === 'Spacebar' || e.keyCode === 13 || e.keyCode === 32) {
          e.preventDefault(); openFrom(tile);
        }
      });
    });
  }

  function onHoverOver(e){
    var t = e.target.closest('.box__row-cell');
    if (!t || !grid.contains(t)) return;
    grid.classList.add('is-hover');
    tiles.forEach(function(x){ x.classList.toggle('is-hovered', x===t); });
  }
  function onHoverOut(e){
    if (!grid.contains(e.relatedTarget)) {
      grid.classList.remove('is-hover');
      tiles.forEach(function(x){ x.classList.remove('is-hovered'); });
    }
  }

  function injectCloseButton(){
    if (document.getElementById('stageClose')) return;
    var btn = document.createElement('button');
    btn.className = 'stage__close';
    btn.id = 'stageClose';
    btn.type = 'button';
    btn.setAttribute('aria-label','Close details');
    btn.innerHTML = '<span class="inner"><span class="label">Back</span></span>';
    stageRight.appendChild(btn);

    btn.addEventListener('click', closeStage);
    btn.addEventListener('keydown', function(e){
      var k = e.key || e.code;
      if (k === 'Enter' || k === ' ' || k === 'Spacebar' || e.keyCode === 13 || e.keyCode === 32) {
        e.preventDefault(); closeStage();
      }
    });
    return btn;
  }
  function removeCloseButton(){
    var btn = document.getElementById('stageClose');
    if (btn && btn.parentNode) btn.parentNode.removeChild(btn);
  }

  /* ===== SC Carousel ===== */
  function mountSC(images){
    stageLeft.innerHTML = '';

    var root = document.createElement('div');
    root.className = 'sc';
    root.setAttribute('aria-roledescription','carousel');

    var viewport = document.createElement('div');
    viewport.className = 'sc__viewport';

    var track = document.createElement('div');
    track.className = 'sc__track';

    var arr = (images && images.length) ? images : [''];
    arr.forEach(function(src, i){
      var slide = document.createElement('div');
      slide.className = 'sc__slide';
      slide.setAttribute('aria-roledescription','slide');
      slide.setAttribute('aria-label', (i+1) + ' of ' + arr.length);

      var media = document.createElement('div');
      media.className = 'sc__media';

      if (src) {
        var img = document.createElement('img');
        img.src = src;
        img.alt = '';
        img.decoding = 'async';
        img.loading = 'eager';
        media.appendChild(img);
      }
      slide.appendChild(media);
      track.appendChild(slide);
    });

    viewport.appendChild(track);

    var btnPrev = document.createElement('button');
    btnPrev.className = 'sc__nav sc__nav--prev';
    btnPrev.type = 'button';
    btnPrev.setAttribute('aria-label','Previous slide');
    btnPrev.textContent = '‹';

    var btnNext = document.createElement('button');
    btnNext.className = 'sc__nav sc__nav--next';
    btnNext.type = 'button';
    btnNext.setAttribute('aria-label','Next slide');
    btnNext.textContent = '›';

    var controls = document.createElement('div');
    controls.className = 'sc__controls';
    controls.setAttribute('aria-live','polite');

    var toggleBtn = document.createElement('button');
    toggleBtn.className = 'sc__toggle';
    toggleBtn.type = 'button';
    toggleBtn.setAttribute('aria-pressed','true');
    toggleBtn.setAttribute('aria-label','Pause autoplay');
    toggleBtn.textContent = 'Pause';

    var dotsWrap = document.createElement('div');
    dotsWrap.className = 'sc__dots';
    dotsWrap.setAttribute('role','tablist');
    dotsWrap.setAttribute('aria-label','Slide selectors');

    controls.appendChild(toggleBtn);
    controls.appendChild(dotsWrap);

    viewport.appendChild(btnPrev);
    viewport.appendChild(btnNext);
    viewport.appendChild(controls);
    root.appendChild(viewport);
    stageLeft.appendChild(root);

    var slides = Array.prototype.slice.call(track.querySelectorAll('.sc__slide'));
    var dots = [];
    slides.forEach(function(_, i){
      var d = document.createElement('button');
      d.className = 'sc__dot';
      d.type = 'button';
      d.setAttribute('role','tab');
      d.setAttribute('aria-label','Go to slide ' + (i+1));
      d.addEventListener('click', function(){ goTo(i, true); });
      dotsWrap.appendChild(d);
      dots.push(d);
    });

    slides.forEach(function(slide, i){
      slide.id = 'sc-slide-' + (i+1);
      slide.setAttribute('aria-label', (i+1) + ' of ' + slides.length);
    });

    var autoplayDefault = true;
    var interval = 5000;
    var index = 0;
    var timer = null;
    var playing = autoplayDefault;

    function render(offsetPct){
      var base = -index * 100;
      track.style.transform = 'translateX(' + (base + (offsetPct || 0)) + '%)';
      dots.forEach(function(d, i){ d.setAttribute('aria-selected', i===index ? 'true' : 'false'); });
    }
    function goTo(i, user){
      if (i < 0) i = slides.length - 1;
      if (i >= slides.length) i = 0;
      index = i;
      track.style.transition = 'transform .4s ease';
      render(0);
      if (user && playing) { stop(); start(); }
    }
    function start(){ stop(); timer = setInterval(function(){ goTo(index + 1, false); }, interval); }
    function stop(){ if (timer) { clearInterval(timer); timer = null; } }

    btnPrev.addEventListener('click', function(){ goTo(index - 1, true); });
    btnNext.addEventListener('click', function(){ goTo(index + 1, true); });

    toggleBtn.addEventListener('click', function(){
      playing = !playing;
      toggleBtn.setAttribute('aria-pressed', String(playing));
      toggleBtn.setAttribute('aria-label', playing ? 'Pause autoplay' : 'Play slideshow');
      toggleBtn.textContent = playing ? 'Pause' : 'Play';
      if (playing) start(); else stop();
    });

    var dragging = false, startX = 0, lastX = 0, dragged = false;
    var thresholdPx = 40;
    function trackWidth(){ return stageLeft.clientWidth; }

    track.addEventListener('pointerdown', function(e){
      if (e.button !== 0) return;
      dragging = true; dragged = false;
      startX = lastX = e.clientX;
      track.style.transition = 'none';
      track.classList.add('is-dragging');
      if (playing) stop();
    });
    track.addEventListener('pointermove', function(e){
      if (!dragging) return;
      lastX = e.clientX;
      var dx = lastX - startX;
      var pct = (dx / trackWidth()) * 100;
      render(pct);
    }, { passive: true });
    function endDrag(){
      if (!dragging) return;
      dragging = false;
      track.classList.remove('is-dragging');
      var dx = lastX - startX;
      if (Math.abs(dx) > thresholdPx) {
        dragged = true;
        if (dx < 0) goTo(index + 1, true); else goTo(index - 1, true);
      } else {
        track.style.transition = 'transform .2s ease';
        render(0);
      }
      if (playing) start();
      startX = lastX = 0;
    }
    track.addEventListener('pointerup', endDrag);
    track.addEventListener('pointercancel', endDrag);
    track.addEventListener('pointerleave', function(){ if (dragging) endDrag(); });

    track.addEventListener('click', function(e){
      if (dragged && e.target.closest('.sc__slide a')) {
        e.preventDefault(); e.stopPropagation(); dragged = false;
      }
    }, true);

    toggleBtn.setAttribute('aria-pressed', String(playing));
    toggleBtn.setAttribute('aria-label', playing ? 'Pause autoplay' : 'Play slideshow');
    render(0);
    if (playing) start();
  }

  /* ==== Stage positioning & clamping ==== */
  function updateStagePosition(){
    if (!stage.classList.contains('is-open')) return;
    var edge = cssPx('--stage-edge', 16);

    var r = box.getBoundingClientRect();
    var vw = window.innerWidth;
    var vh = window.innerHeight;

    // anchor to the visible top-left of the .box (clamped by edge)
    var left = Math.max(edge, Math.min(r.left, vw - edge));
    var top  = Math.max(edge, Math.min(r.top,  vh - edge));

    // width that stays on-screen and within the box’s width
    var maxWidthByViewport = vw - left - edge;
    var width = Math.min(r.width, Math.max(0, maxWidthByViewport));

    stage.style.left = left + 'px';
    stage.style.top  = top  + 'px';
    stage.style.right = edge + 'px';  // keep a right margin
    stage.style.width = width + 'px';
  }

  function bindRepositionHandlers(){
    if (repositionHandlersBound) return;
    repositionHandlersBound = true;
    window.addEventListener('scroll', updateStagePosition, { passive:true });
    window.addEventListener('resize', updateStagePosition);
  }
  function unbindRepositionHandlers(){
    if (!repositionHandlersBound) return;
    repositionHandlersBound = false;
    window.removeEventListener('scroll', updateStagePosition);
    window.removeEventListener('resize', updateStagePosition);
  }

  function hideGridOnly(){
    grid.classList.add('is-hidden');
    grid.classList.remove('is-fading');
  }

  function openFrom(tile){
    if (animating) return;
    animating = true;
    lastSourceTile = tile;

    removeCloseButton();

    var idx = parseInt(tile.dataset.index, 10) || 0;
    var item = items[idx] || {};

    grid.classList.add('is-fading');
    tile.classList.add('is-source','stagger-out');
    tile.offsetHeight;
    tile.classList.add('run');

    // Count 4 stagger parts (img, line, title, role)
    var tcfg = readTimings();
    var parts = 4;
    var totalStagger = tcfg.staggerDur + tcfg.staggerStep * (parts - 1);
    stage.style.setProperty('--stage-delay', (totalStagger / 1000).toFixed(3) + 's');

    var gallery = Array.isArray(item.gallery) && item.gallery.length ? item.gallery : [item.cover || ''];
    mountSC(gallery);

    panelTitle.textContent = item.title || 'Project';
    panelRole.textContent  = item.role || '';
    panelDesc.textContent  = item.description || '';

    panelLinks.innerHTML = '';
    var linkCount = 0;
    if (item.links && (item.links.website || item.links.caseStudy)) {
      if (item.links.website)   { panelLinks.appendChild(linkEl('Website', item.links.website)); linkCount++; }
      if (item.links.caseStudy) { panelLinks.appendChild(linkEl('Case Study', item.links.caseStudy)); linkCount++; }
    }
    panelLinks.hidden = linkCount === 0;

    panelTags.innerHTML = '';
    if (Array.isArray(item.tags) && item.tags.length) {
      item.tags.forEach(function(t){
        var span = document.createElement('span');
        span.className = 'panel__tag';
        span.textContent = t;
        panelTags.appendChild(span);
      });
      panelTags.hidden = false;
    } else {
      panelTags.hidden = true;
    }

    // Open and switch to fixed mode before animations so it’s always on-screen
    stage.classList.add('is-open','is-fixed');
    updateStagePosition();
    bindRepositionHandlers();

    var prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (prefersReduced) {
      requestAnimationFrame(hideGridOnly);
    } else {
      var onLeftStart = function(e){
        if (e.target !== stageLeft) return;
        // desktop uses slideInLeft, mobile uses dropIn — both start the same frame
        stageLeft.removeEventListener('animationstart', onLeftStart);
        hideGridOnly();
      };
      stageLeft.addEventListener('animationstart', onLeftStart);
    }

    var onRightIn = function(e){
      if (e.target !== stageRight) return;
      // Accept both desktop and mobile animation names
      if (e.animationName && !/slideInRight|dropIn/.test(e.animationName)) return;
      stageRight.removeEventListener('animationend', onRightIn);

      var btn = injectCloseButton();
      if (btn) btn.focus();

      tiles.forEach(function(t){ t.classList.remove('stagger-out','run','is-source'); });

      animating = false;
    };
    stageRight.addEventListener('animationend', onRightIn);
  }

  function linkEl(label, href){
    var a = document.createElement('a');
    a.className = 'panel__link';
    a.href = href; a.target = '_blank'; a.rel = 'noopener';
    a.textContent = label;
    return a;
  }

  function closeStage(){
    if (animating || !stage.classList.contains('is-open')) return;
    animating = true;

    stage.classList.add('is-closing');

    var tcfg = readTimings();
    setTimeout(function(){
      // tear down fixed mode + listeners
      unbindRepositionHandlers();
      stage.classList.remove('is-open','is-closing','is-fixed');
      stage.style.left = stage.style.top = stage.style.right = stage.style.width = '';

      removeCloseButton();

      grid.classList.remove('is-hidden');

      var prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (prefersReduced) {
        grid.classList.remove('is-revealing');
        if (lastSourceTile) lastSourceTile.focus();
        animating = false;
        return;
      }

      grid.classList.add('is-revealing');

      var remaining = tiles.length;
      function onAnimEnd(e){
        if (!e || !e.target || !e.target.classList.contains('box__row-cell')) return;
        if (e.animationName !== 'tileIn') return;
        remaining--;
        if (remaining <= 0) {
          grid.removeEventListener('animationend', onAnimEnd, true);
          grid.classList.remove('is-revealing');
          if (lastSourceTile) lastSourceTile.focus();
          animating = false;
        }
      }
      grid.addEventListener('animationend', onAnimEnd, true);
    }, tcfg.stageOut + 20);
  }

  document.addEventListener('keydown', function(e){
    if (e.key === 'Escape' && stage.classList.contains('is-open')) closeStage();
  });

  loadData();
})();
</script>	
</html>